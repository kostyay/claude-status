{"id":"claude-status-00o","title":"Add logging to HasBeads() when errors occur","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T21:53:15.218299+01:00","created_by":"kostya","updated_at":"2026-01-03T22:14:11.414746+01:00","closed_at":"2026-01-03T22:14:11.414746+01:00","close_reason":"Closed"}
{"id":"claude-status-04a","title":"Add TemplateWithBeads example template","description":"Add new const to internal/config/config.go:\nTemplateWithBeads showing multi-line output with beads widget on second line.\nFormat: Line1 has model/dir/branch/context, Line2 has beads stats and next task.\nInclude in code comments as example for users.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:02:43.253715+01:00","created_by":"kostya","updated_at":"2026-01-03T21:11:43.260735+01:00","closed_at":"2026-01-03T21:11:43.260735+01:00","close_reason":"Implemented beads widget feature","dependencies":[{"issue_id":"claude-status-04a","depends_on_id":"claude-status-1ks","type":"blocks","created_at":"2026-01-03T21:03:26.721445+01:00","created_by":"kostya"},{"issue_id":"claude-status-04a","depends_on_id":"claude-status-sei","type":"parent-child","created_at":"2026-01-03T21:03:38.925087+01:00","created_by":"kostya"}]}
{"id":"claude-status-13a","title":"Add workDir parameter to NewBuilderWithDeps","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-03T21:53:16.27354+01:00","created_by":"kostya","updated_at":"2026-01-03T22:14:11.420861+01:00","closed_at":"2026-01-03T22:14:11.420861+01:00","close_reason":"Closed"}
{"id":"claude-status-1ag","title":"Add template functions: fmtTokens, fmtPct, fmtSigned","description":"Add formatting functions to template.FuncMap: fmtTokens (10500 → 10.5k), fmtPct (45.2 → 45.2%), fmtSigned (42 → +42). Export tokens.FormatTokens for use in template package.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T10:08:46.613786+01:00","created_by":"kostya","updated_at":"2026-01-04T10:11:35.83873+01:00","closed_at":"2026-01-04T10:11:35.83873+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-1ag","depends_on_id":"claude-status-duz","type":"blocks","created_at":"2026-01-04T10:08:55.394969+01:00","created_by":"kostya"}]}
{"id":"claude-status-1ks","title":"Integrate beads stats fetching in status.Builder.Build()","description":"Update Build() method:\n- Check if beads provider is enabled\n- If enabled, fetch stats via cache with configured TTL\n- Populate StatusData beads fields from Stats\n- Handle errors gracefully (log and continue without beads data)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:02:43.003586+01:00","created_by":"kostya","updated_at":"2026-01-03T21:11:43.257784+01:00","closed_at":"2026-01-03T21:11:43.257784+01:00","close_reason":"Implemented beads widget feature","dependencies":[{"issue_id":"claude-status-1ks","depends_on_id":"claude-status-yx0","type":"blocks","created_at":"2026-01-03T21:03:20.218734+01:00","created_by":"kostya"},{"issue_id":"claude-status-1ks","depends_on_id":"claude-status-q1v","type":"blocks","created_at":"2026-01-03T21:03:20.304246+01:00","created_by":"kostya"},{"issue_id":"claude-status-1ks","depends_on_id":"claude-status-chz","type":"blocks","created_at":"2026-01-03T21:03:20.391597+01:00","created_by":"kostya"},{"issue_id":"claude-status-1ks","depends_on_id":"claude-status-2hp","type":"blocks","created_at":"2026-01-03T21:03:20.466893+01:00","created_by":"kostya"},{"issue_id":"claude-status-1ks","depends_on_id":"claude-status-sei","type":"parent-child","created_at":"2026-01-03T21:03:38.837314+01:00","created_by":"kostya"}]}
{"id":"claude-status-1mm","title":"Run tests and verify TestE2E_BeadsRealCLI passes","description":"Execute 'make test' to verify the new integration test passes. Ensure test properly skips on systems without bd installed.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:17:46.757053+01:00","created_by":"kostya","updated_at":"2026-01-03T21:23:30.385267+01:00","closed_at":"2026-01-03T21:23:30.385267+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-1mm","depends_on_id":"claude-status-um2","type":"blocks","created_at":"2026-01-03T21:19:35.345113+01:00","created_by":"kostya"}]}
{"id":"claude-status-20j","title":"Add unit tests for GetNextTask() method","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:53:15.612259+01:00","created_by":"kostya","updated_at":"2026-01-03T22:14:11.417789+01:00","closed_at":"2026-01-03T22:14:11.417789+01:00","close_reason":"Closed"}
{"id":"claude-status-2hp","title":"Add BeadsProvider interface to status.Builder","description":"Update internal/status/status.go:\n- Add BeadsProvider interface with IsEnabled() bool and GetStats() (beads.Stats, error)\n- Add beads field to Builder struct\n- Update NewBuilder to initialize beads client if .beads/ exists\n- Update NewBuilderWithDeps to accept BeadsProvider parameter","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:02:42.763183+01:00","created_by":"kostya","updated_at":"2026-01-03T21:11:43.254131+01:00","closed_at":"2026-01-03T21:11:43.254131+01:00","close_reason":"Implemented beads widget feature","dependencies":[{"issue_id":"claude-status-2hp","depends_on_id":"claude-status-cc6","type":"blocks","created_at":"2026-01-03T21:03:18.382569+01:00","created_by":"kostya"},{"issue_id":"claude-status-2hp","depends_on_id":"claude-status-sei","type":"parent-child","created_at":"2026-01-03T21:03:38.757888+01:00","created_by":"kostya"}]}
{"id":"claude-status-32w","title":"Add helper function to create beads tasks","description":"Create createBeadsTasks(t, dir) helper to run 'bd create' commands to add test tasks and set up dependencies","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:17:46.357224+01:00","created_by":"kostya","updated_at":"2026-01-03T21:23:30.380723+01:00","closed_at":"2026-01-03T21:23:30.380723+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-32w","depends_on_id":"claude-status-ajh","type":"blocks","created_at":"2026-01-03T21:19:34.798413+01:00","created_by":"kostya"}]}
{"id":"claude-status-3tl","title":"Parse --prefix CLI flag in main.go","description":"Add flag parsing for --prefix argument in cmd/claude-status/main.go, pass value through to status builder","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T22:20:23.39766+01:00","created_by":"kostya","updated_at":"2026-01-03T22:37:58.505717+01:00","closed_at":"2026-01-03T22:37:58.505717+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-3tl","depends_on_id":"claude-status-tig","type":"blocks","created_at":"2026-01-03T22:20:32.330598+01:00","created_by":"kostya"}]}
{"id":"claude-status-40x","title":"Update status.go: remove formatting logic","description":"Remove populateDiffStats formatting (lines 234-252), populateBeadsStats formatting (346-357), and populateTokenMetrics formatted string assignments. Only assign raw values to fields.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T10:08:46.801114+01:00","created_by":"kostya","updated_at":"2026-01-04T10:12:38.840929+01:00","closed_at":"2026-01-04T10:12:38.840929+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-40x","depends_on_id":"claude-status-duz","type":"blocks","created_at":"2026-01-04T10:08:55.476682+01:00","created_by":"kostya"}]}
{"id":"claude-status-4ax","title":"Add --prefix CLI argument for profile identification","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-03T22:20:12.266772+01:00","created_by":"kostya","updated_at":"2026-01-03T22:39:22.562532+01:00","closed_at":"2026-01-03T22:39:22.562532+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-4ax","depends_on_id":"claude-status-6et","type":"blocks","created_at":"2026-01-03T22:24:33.229106+01:00","created_by":"kostya"}]}
{"id":"claude-status-4o8","title":"Move icon/formatting from code to templates","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-04T10:08:32.933853+01:00","created_by":"kostya","updated_at":"2026-01-04T10:17:04.112652+01:00","closed_at":"2026-01-04T10:17:04.112652+01:00","close_reason":"Closed"}
{"id":"claude-status-54d","title":"Write unit tests for beads caching","description":"Update internal/cache/cache_test.go with tests for:\n- GetBeadsStats with fresh fetch\n- GetBeadsStats with cached value (within TTL)\n- GetBeadsStats with expired cache (after TTL)\n- Error handling when fetchFn fails","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:02:43.737271+01:00","created_by":"kostya","updated_at":"2026-01-03T21:11:43.259519+01:00","closed_at":"2026-01-03T21:11:43.259519+01:00","close_reason":"Implemented beads widget feature","dependencies":[{"issue_id":"claude-status-54d","depends_on_id":"claude-status-chz","type":"blocks","created_at":"2026-01-03T21:03:30.087148+01:00","created_by":"kostya"},{"issue_id":"claude-status-54d","depends_on_id":"claude-status-sei","type":"parent-child","created_at":"2026-01-03T21:03:39.100344+01:00","created_by":"kostya"}]}
{"id":"claude-status-5ik","title":"Add in-memory cache to reduce disk I/O","description":"## Problem\nThe `load()` function reads and parses the entire cache file from disk on every cache operation. In `GetBeadsStats`, this happens at least twice (once under RLock, once under Lock on cache miss).\n\n**File:** `internal/cache/cache.go` lines 411-427\n\n## Impact\nMultiple disk reads and JSON unmarshals per status line generation:\n- GetGitBranch (2x load on miss)\n- GetGitStatus (2x load on miss)\n- GetGitDiffStats (2x load on miss)\n- GetGitHubBuild (2x load on miss)\n- GetBeadsStats (2x load on miss)\n\n**Total:** Up to 10 file reads and JSON parses per run\n\n## Solution\nAdd in-memory cache with dirty flag:\n\n```go\ntype Manager struct {\n    cacheDir    string\n    cachePath   string\n    clock       Clock\n    mu          sync.RWMutex\n    fileLock    *flock.Flock\n    memCache    *CacheFile  // In-memory cache\n    cacheLoaded bool        // Whether memCache is populated\n}\n\nfunc (m *Manager) load() *CacheFile {\n    if m.cacheLoaded \u0026\u0026 m.memCache != nil {\n        return m.memCache\n    }\n    \n    data, err := os.ReadFile(m.cachePath)\n    // ... existing parsing ...\n    \n    m.memCache = \u0026cache\n    m.cacheLoaded = true\n    return \u0026cache\n}\n```\n\n## Tasks\n- [ ] Add memCache and cacheLoaded fields to Manager\n- [ ] Modify load() to use in-memory cache\n- [ ] Invalidate memCache on save()\n- [ ] Update tests to verify reduced I/O\n- [ ] Verify with `make test`","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T23:07:28.418014+01:00","created_by":"kostya","updated_at":"2026-01-03T23:23:48.151693+01:00","closed_at":"2026-01-03T23:23:48.151693+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-5ik","depends_on_id":"claude-status-ck5","type":"blocks","created_at":"2026-01-03T23:07:33.207197+01:00","created_by":"kostya"}]}
{"id":"claude-status-5qu","title":"Add debug log when beads initialization skipped in NewBuilder","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:53:15.409162+01:00","created_by":"kostya","updated_at":"2026-01-03T22:14:11.416688+01:00","closed_at":"2026-01-03T22:14:11.416688+01:00","close_reason":"Closed"}
{"id":"claude-status-6bx","title":"Add 2-second timeout to beads commands","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-03T21:53:16.040835+01:00","created_by":"kostya","updated_at":"2026-01-03T22:14:11.419735+01:00","closed_at":"2026-01-03T22:14:11.419735+01:00","close_reason":"Closed"}
{"id":"claude-status-6et","title":"Add tests for prefix functionality","description":"Add unit tests for: 1) Prefix field in StatusData renders correctly, 2) Prefix with template functions (colors) works, 3) Empty prefix produces no output","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T22:20:23.765902+01:00","created_by":"kostya","updated_at":"2026-01-03T22:39:22.561062+01:00","closed_at":"2026-01-03T22:39:22.561062+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-6et","depends_on_id":"claude-status-3tl","type":"blocks","created_at":"2026-01-03T22:20:32.481437+01:00","created_by":"kostya"},{"issue_id":"claude-status-6et","depends_on_id":"claude-status-85x","type":"blocks","created_at":"2026-01-03T22:20:32.562976+01:00","created_by":"kostya"}]}
{"id":"claude-status-85x","title":"Update DefaultTemplate to include prefix","description":"Modify DefaultTemplate in internal/config/config.go to render {{.Prefix}} at the start (with conditional to avoid extra space when empty)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T22:20:23.579791+01:00","created_by":"kostya","updated_at":"2026-01-03T22:36:59.736435+01:00","closed_at":"2026-01-03T22:36:59.736435+01:00","close_reason":"Closed"}
{"id":"claude-status-8p4","title":"Add caching for GetNextTask()","description":"## Problem\nThe comment says \"not cached, fast enough\" but `GetNextTask()` runs `bd ready --json` which has the same 10-second timeout as other beads commands.\n\n**File:** `internal/status/status.go` lines 315-321\n\n```go\n// Get next task (not cached, fast enough)\nnextTask, err := b.beads.GetNextTask()\n```\n\n## Impact\nAdditional 10s potential latency that could be avoided with caching.\n\n## Solution\nCache `GetNextTask()` with the same TTL as `GetStats()` (5 seconds):\n\n1. Add `CachedNextTask` to cache structure\n2. Create `GetCachedNextTask()` method in cache.Manager\n3. Update status.Builder to use cached version\n\n## Tasks\n- [ ] Add CachedNextTask struct to cache.go\n- [ ] Add NextTaskMap to CacheFile (per-project like BeadsStats)\n- [ ] Implement GetNextTask/SetNextTask in cache.Manager\n- [ ] Update status.Builder to use cache\n- [ ] Add tests\n- [ ] Verify with `make test`","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T23:07:28.609933+01:00","created_by":"kostya","updated_at":"2026-01-03T23:23:48.154489+01:00","closed_at":"2026-01-03T23:23:48.154489+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-8p4","depends_on_id":"claude-status-ck5","type":"blocks","created_at":"2026-01-03T23:07:33.282422+01:00","created_by":"kostya"}]}
{"id":"claude-status-9eb","title":"Write unit tests for internal/beads package","description":"Create internal/beads/beads_test.go with tests for:\n- IsEnabled() with and without .beads/ directory\n- GetStats() with mocked bd commands\n- JSON parsing for bd stats output\n- JSON parsing for bd ready output\n- Timeout handling\n- Error cases (command failure, invalid JSON)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:02:43.497394+01:00","created_by":"kostya","updated_at":"2026-01-03T21:11:43.255337+01:00","closed_at":"2026-01-03T21:11:43.255337+01:00","close_reason":"Implemented beads widget feature","dependencies":[{"issue_id":"claude-status-9eb","depends_on_id":"claude-status-cc6","type":"blocks","created_at":"2026-01-03T21:03:30.003528+01:00","created_by":"kostya"},{"issue_id":"claude-status-9eb","depends_on_id":"claude-status-sei","type":"parent-child","created_at":"2026-01-03T21:03:39.013388+01:00","created_by":"kostya"}]}
{"id":"claude-status-ajh","title":"Add helper function to initialize beads in directory","description":"Create initBeads(t, dir) helper to run 'bd init --prefix test --skip-hooks --sandbox' in the temp directory","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:17:46.168091+01:00","created_by":"kostya","updated_at":"2026-01-03T21:23:30.37942+01:00","closed_at":"2026-01-03T21:23:30.37942+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-ajh","depends_on_id":"claude-status-au0","type":"blocks","created_at":"2026-01-03T21:19:34.627435+01:00","created_by":"kostya"}]}
{"id":"claude-status-au0","title":"Add helper function to initialize git repo in temp directory","description":"Create initGitRepo(t, dir) helper to run git init, config user.email/name, and initial commit. Follows existing TestE2E_RealGitRepo pattern.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:17:45.99585+01:00","created_by":"kostya","updated_at":"2026-01-03T21:23:30.378022+01:00","closed_at":"2026-01-03T21:23:30.378022+01:00","close_reason":"Closed"}
{"id":"claude-status-b9l","title":"Add Prefix field to StatusData struct","description":"Add a Prefix string field to template.StatusData in internal/template/template.go","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T22:20:23.054838+01:00","created_by":"kostya","updated_at":"2026-01-03T22:36:40.241486+01:00","closed_at":"2026-01-03T22:36:40.241486+01:00","close_reason":"Closed"}
{"id":"claude-status-bct","title":"Add real E2E beads integration test using actual CLI","description":"Add a true integration test that sets up an actual beads database via the bd CLI tool, creates tasks, and validates parsing against real data. Currently all beads tests use mocks.","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-03T21:17:33.284755+01:00","created_by":"kostya","updated_at":"2026-01-03T21:23:30.387004+01:00","closed_at":"2026-01-03T21:23:30.387004+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-bct","depends_on_id":"claude-status-1mm","type":"blocks","created_at":"2026-01-03T21:19:35.509541+01:00","created_by":"kostya"}]}
{"id":"claude-status-c9o","title":"Update README with new template syntax","description":"Document breaking changes, new field names, and available template functions (fmtTokens, fmtPct, fmtSigned).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T10:08:47.423262+01:00","created_by":"kostya","updated_at":"2026-01-04T10:17:04.111285+01:00","closed_at":"2026-01-04T10:17:04.111285+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-c9o","depends_on_id":"claude-status-cja","type":"blocks","created_at":"2026-01-04T10:08:55.785121+01:00","created_by":"kostya"}]}
{"id":"claude-status-cc6","title":"Implement beads.Client.GetStats() method","description":"Implement GetStats() that:\n- Runs 'bd stats --json' to get open/in_progress/blocked counts\n- Runs 'bd ready --limit 1 --json' to get next task title and ID\n- Parses JSON responses into Stats struct\n- Truncates NextTask title to 40 chars if needed\n- Uses 2-second timeout for each command\n- Returns error if bd command fails or JSON parsing fails","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:02:41.79456+01:00","created_by":"kostya","updated_at":"2026-01-03T21:11:43.252807+01:00","closed_at":"2026-01-03T21:11:43.252807+01:00","close_reason":"Implemented beads widget feature","dependencies":[{"issue_id":"claude-status-cc6","depends_on_id":"claude-status-sh7","type":"blocks","created_at":"2026-01-03T21:03:14.048962+01:00","created_by":"kostya"},{"issue_id":"claude-status-cc6","depends_on_id":"claude-status-sei","type":"parent-child","created_at":"2026-01-03T21:03:38.429834+01:00","created_by":"kostya"}]}
{"id":"claude-status-chz","title":"Add GetBeadsStats to CacheProvider interface and implement in cache.Manager","description":"Update caching layer:\n- Add GetBeadsStats(ttl time.Duration, fetchFn func() (beads.Stats, error)) method to CacheProvider interface\n- Implement in cache.Manager with TTL-based invalidation\n- Store beads stats in cache with expiration timestamp\n- Return cached value if not expired, otherwise call fetchFn","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:02:42.520273+01:00","created_by":"kostya","updated_at":"2026-01-03T21:11:43.256525+01:00","closed_at":"2026-01-03T21:11:43.256525+01:00","close_reason":"Implemented beads widget feature","dependencies":[{"issue_id":"claude-status-chz","depends_on_id":"claude-status-cc6","type":"blocks","created_at":"2026-01-03T21:03:15.871219+01:00","created_by":"kostya"},{"issue_id":"claude-status-chz","depends_on_id":"claude-status-sei","type":"parent-child","created_at":"2026-01-03T21:03:38.672147+01:00","created_by":"kostya"}]}
{"id":"claude-status-cja","title":"Update tests for new StatusData structure","description":"Update status_test.go and template_test.go to use new field names and test template functions.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T10:08:47.201317+01:00","created_by":"kostya","updated_at":"2026-01-04T10:15:24.647247+01:00","closed_at":"2026-01-04T10:15:24.647247+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-cja","depends_on_id":"claude-status-40x","type":"blocks","created_at":"2026-01-04T10:08:55.622459+01:00","created_by":"kostya"},{"issue_id":"claude-status-cja","depends_on_id":"claude-status-ptp","type":"blocks","created_at":"2026-01-04T10:08:55.701759+01:00","created_by":"kostya"}]}
{"id":"claude-status-ck5","title":"Performance improvements from code review","description":"Address performance issues identified in go-code-reviewer analysis (rated 7/10).\n\n## Critical Issues\n1. Duplicate bd stats execution - 2x subprocess calls\n2. Cache file read on every operation - 10+ disk reads per run\n\n## Important Issues  \n3. GetNextTask() not cached - +10s potential latency\n4. Unbounded BeadsStatsMap growth - cache file bloat\n\n## Success Criteria\n- Eliminate duplicate subprocess calls\n- Reduce disk I/O to 1 read per status line generation\n- Add caching for GetNextTask()\n- Implement cache eviction strategy","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-03T23:06:47.24598+01:00","created_by":"kostya","updated_at":"2026-01-03T23:23:48.156803+01:00","closed_at":"2026-01-03T23:23:48.156803+01:00","close_reason":"Closed"}
{"id":"claude-status-duz","title":"Update StatusData struct: remove formatted fields, rename *Raw","description":"Remove string fields (GitAdditions, TokensInput, BeadsReady, etc). Rename *Raw fields to drop suffix (GitAdditionsRaw → GitAdditions). This is a breaking change.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T10:08:46.430201+01:00","created_by":"kostya","updated_at":"2026-01-04T10:11:10.191482+01:00","closed_at":"2026-01-04T10:11:10.191482+01:00","close_reason":"Closed"}
{"id":"claude-status-e0u","title":"Log non-NotExist errors in cache load()","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-03T21:53:16.493634+01:00","created_by":"kostya","updated_at":"2026-01-03T22:14:11.421868+01:00","closed_at":"2026-01-03T22:14:11.421868+01:00","close_reason":"Closed"}
{"id":"claude-status-ehd","title":"Address PR review feedback for beads integration","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-03T21:53:06.477945+01:00","created_by":"kostya","updated_at":"2026-01-03T22:14:49.378981+01:00","closed_at":"2026-01-03T22:14:49.378981+01:00","close_reason":"All subtasks completed: logging, tests, timeout, and cleanup done","dependencies":[{"issue_id":"claude-status-ehd","depends_on_id":"claude-status-00o","type":"blocks","created_at":"2026-01-03T21:53:45.875536+01:00","created_by":"kostya"},{"issue_id":"claude-status-ehd","depends_on_id":"claude-status-5qu","type":"blocks","created_at":"2026-01-03T21:53:45.982487+01:00","created_by":"kostya"},{"issue_id":"claude-status-ehd","depends_on_id":"claude-status-20j","type":"blocks","created_at":"2026-01-03T21:53:46.08237+01:00","created_by":"kostya"},{"issue_id":"claude-status-ehd","depends_on_id":"claude-status-rco","type":"blocks","created_at":"2026-01-03T21:53:46.181778+01:00","created_by":"kostya"},{"issue_id":"claude-status-ehd","depends_on_id":"claude-status-6bx","type":"blocks","created_at":"2026-01-03T21:53:46.282388+01:00","created_by":"kostya"},{"issue_id":"claude-status-ehd","depends_on_id":"claude-status-13a","type":"blocks","created_at":"2026-01-03T21:53:46.386914+01:00","created_by":"kostya"},{"issue_id":"claude-status-ehd","depends_on_id":"claude-status-e0u","type":"blocks","created_at":"2026-01-03T21:53:46.498668+01:00","created_by":"kostya"}]}
{"id":"claude-status-ehp","title":"Add helper function to skip test if bd CLI not installed","description":"Create skipIfBdNotAvailable(t) helper using exec.LookPath('bd') pattern matching existing git skip pattern","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:17:45.813393+01:00","created_by":"kostya","updated_at":"2026-01-03T21:23:30.376048+01:00","closed_at":"2026-01-03T21:23:30.376048+01:00","close_reason":"Closed"}
{"id":"claude-status-ir1","title":"Test task for status line","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:33:12.559434+01:00","created_by":"kostya","updated_at":"2026-01-03T21:35:08.435009+01:00","closed_at":"2026-01-03T21:35:08.435009+01:00","close_reason":"Test task for status line feature"}
{"id":"claude-status-ptp","title":"Update default templates in config.go","description":"Update DefaultTemplate, TemplateWithTokens, TemplateWithBeads to use new field names and template functions. Add emojis directly in templates. Ensure output matches current behavior.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T10:08:47.0021+01:00","created_by":"kostya","updated_at":"2026-01-04T10:13:11.091924+01:00","closed_at":"2026-01-04T10:13:11.091924+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-ptp","depends_on_id":"claude-status-1ag","type":"blocks","created_at":"2026-01-04T10:08:55.552896+01:00","created_by":"kostya"}]}
{"id":"claude-status-q1v","title":"Add BeadsTTL config field with 60s default","description":"Update internal/config/config.go:\n- Add BeadsTTL int json field to Config struct\n- Set default to 60 in Default() function\n- Add merge logic in LoadFrom() for non-zero values","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:02:42.287685+01:00","created_by":"kostya","updated_at":"2026-01-03T21:11:43.24837+01:00","closed_at":"2026-01-03T21:11:43.24837+01:00","close_reason":"Implemented beads widget feature","dependencies":[{"issue_id":"claude-status-q1v","depends_on_id":"claude-status-sei","type":"parent-child","created_at":"2026-01-03T21:03:38.592344+01:00","created_by":"kostya"}]}
{"id":"claude-status-rco","title":"Remove unused workDir field from beads.Client struct","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-03T21:53:15.826277+01:00","created_by":"kostya","updated_at":"2026-01-03T22:14:11.418747+01:00","closed_at":"2026-01-03T22:14:11.418747+01:00","close_reason":"Closed"}
{"id":"claude-status-rip","title":"Eliminate duplicate bd stats execution in HasBeads/GetStats","description":"## Problem\nWhen beads is available, `HasBeads()` runs `bd stats --json`, then `GetStats()` immediately runs the same command again. This means 2x subprocess invocations with 10s timeout each.\n\n**File:** `internal/beads/beads.go` lines 88-93 and 73-84\n\n## Impact\n- 2x subprocess overhead\n- Up to 20s potential timeout for beads data\n\n## Solution Options\n\n### Option 1: Combined function (Recommended)\n```go\nfunc (c *Client) HasBeadsAndStats() (bool, Stats, error) {\n    output, err := c.cmd.Output(\"bd\", \"stats\", \"--json\")\n    if err != nil {\n        slog.Debug(\"beads not available\", \"err\", err, \"output\", string(output))\n        return false, Stats{}, nil\n    }\n    \n    var resp statsResponse\n    if err := json.Unmarshal(output, \u0026resp); err != nil {\n        return true, Stats{}, err\n    }\n    return true, resp.Summary, nil\n}\n```\n\n### Option 2: Directory check for HasBeads\n```go\nfunc (c *Client) HasBeads() bool {\n    _, err := os.Stat(filepath.Join(c.workDir, \".beads\"))\n    return err == nil\n}\n```\n\n## Tasks\n- [ ] Refactor beads client to eliminate duplicate calls\n- [ ] Update status.Builder to use new API\n- [ ] Update tests\n- [ ] Verify with `make test`","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T23:07:28.212506+01:00","created_by":"kostya","updated_at":"2026-01-03T23:23:48.153442+01:00","closed_at":"2026-01-03T23:23:48.153442+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-rip","depends_on_id":"claude-status-ck5","type":"blocks","created_at":"2026-01-03T23:07:33.132171+01:00","created_by":"kostya"}]}
{"id":"claude-status-rl6","title":"Update status_test.go for beads integration","description":"Update internal/status/status_test.go:\n- Add mock BeadsProvider\n- Test Build() with beads enabled\n- Test Build() with beads disabled\n- Test beads fields in StatusData output","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:02:43.983431+01:00","created_by":"kostya","updated_at":"2026-01-03T21:11:43.262038+01:00","closed_at":"2026-01-03T21:11:43.262038+01:00","close_reason":"Implemented beads widget feature","dependencies":[{"issue_id":"claude-status-rl6","depends_on_id":"claude-status-1ks","type":"blocks","created_at":"2026-01-03T21:03:30.172485+01:00","created_by":"kostya"},{"issue_id":"claude-status-rl6","depends_on_id":"claude-status-sei","type":"parent-child","created_at":"2026-01-03T21:03:39.186648+01:00","created_by":"kostya"}]}
{"id":"claude-status-s0n","title":"Add integration test for beads widget","description":"Update integration_test.go:\n- Create temp directory with .beads/ setup\n- Run full pipeline with beads data\n- Verify beads fields appear in output when using TemplateWithBeads","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:02:44.236126+01:00","created_by":"kostya","updated_at":"2026-01-03T21:11:43.26357+01:00","closed_at":"2026-01-03T21:11:43.26357+01:00","close_reason":"Implemented beads widget feature","dependencies":[{"issue_id":"claude-status-s0n","depends_on_id":"claude-status-04a","type":"blocks","created_at":"2026-01-03T21:03:30.24841+01:00","created_by":"kostya"},{"issue_id":"claude-status-s0n","depends_on_id":"claude-status-sei","type":"parent-child","created_at":"2026-01-03T21:03:39.269671+01:00","created_by":"kostya"}]}
{"id":"claude-status-sei","title":"Add beads widget to status line","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-03T21:02:14.316045+01:00","created_by":"kostya","updated_at":"2026-01-03T21:11:43.264847+01:00","closed_at":"2026-01-03T21:11:43.264847+01:00","close_reason":"Implemented beads widget feature"}
{"id":"claude-status-sh7","title":"Create internal/beads package with Stats struct and Client","description":"Create new package internal/beads with:\n- Stats struct (Open, InProgress, Blocked int; NextTask, NextTaskID string)\n- Client struct with workDir field\n- Commander interface for dependency injection (like git package)\n- IsEnabled() bool method - checks for .beads/ directory existence\n- 2-second timeout constant","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:02:41.577609+01:00","created_by":"kostya","updated_at":"2026-01-03T21:11:43.249985+01:00","closed_at":"2026-01-03T21:11:43.249985+01:00","close_reason":"Implemented beads widget feature","dependencies":[{"issue_id":"claude-status-sh7","depends_on_id":"claude-status-sei","type":"parent-child","created_at":"2026-01-03T21:03:38.344022+01:00","created_by":"kostya"}]}
{"id":"claude-status-tig","title":"Process prefix as template in status builder","description":"Update internal/status/status.go to accept prefix string, render it through template engine to support color functions like {{red}}, and populate StatusData.Prefix","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T22:20:23.228426+01:00","created_by":"kostya","updated_at":"2026-01-03T22:37:27.941133+01:00","closed_at":"2026-01-03T22:37:27.941133+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-tig","depends_on_id":"claude-status-b9l","type":"blocks","created_at":"2026-01-03T22:20:32.171628+01:00","created_by":"kostya"}]}
{"id":"claude-status-tun","title":"Implement cache eviction for BeadsStatsMap","description":"## Problem\nThe `BeadsStatsMap` grows unbounded as users work in different project directories. There's no eviction of old entries.\n\n**File:** `internal/cache/cache.go` line 66\n\n```go\nBeadsStatsMap map[string]*CachedBeadsStats `json:\"beads_stats_map,omitempty\"`\n```\n\n## Impact\nCache file grows indefinitely. On machines where developers work on many projects, this could become a multi-megabyte JSON file over time.\n\n## Solution\nImplement age-based cleanup:\n\n```go\nconst maxCacheAge = 7 * 24 * time.Hour  // 1 week\n\nfunc (m *Manager) cleanupOldBeadsStats(cache *CacheFile, maxAge time.Duration) {\n    if cache.BeadsStatsMap == nil {\n        return\n    }\n    now := m.clock.Now()\n    for key, entry := range cache.BeadsStatsMap {\n        if now.Sub(entry.CachedAt) \u003e maxAge {\n            delete(cache.BeadsStatsMap, key)\n        }\n    }\n}\n```\n\nCall this during save() or periodically.\n\n## Tasks\n- [ ] Add cleanupOldEntries method to cache.Manager\n- [ ] Define reasonable max age (suggest 7 days)\n- [ ] Call cleanup during save() operations\n- [ ] Also apply to NextTaskMap (from related task)\n- [ ] Add tests for eviction logic\n- [ ] Verify with `make test`","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-03T23:07:28.781762+01:00","created_by":"kostya","updated_at":"2026-01-03T23:23:48.155619+01:00","closed_at":"2026-01-03T23:23:48.155619+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-tun","depends_on_id":"claude-status-ck5","type":"blocks","created_at":"2026-01-03T23:07:33.376186+01:00","created_by":"kostya"}]}
{"id":"claude-status-um2","title":"Write TestE2E_BeadsRealCLI test function","description":"Main test function that: 1) skips if bd not available, 2) creates temp dir, 3) initializes git, 4) initializes beads, 5) creates tasks, 6) calls beads.NewClient().GetStats(), 7) verifies counts match expected","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:17:46.555349+01:00","created_by":"kostya","updated_at":"2026-01-03T21:23:30.382337+01:00","closed_at":"2026-01-03T21:23:30.382337+01:00","close_reason":"Closed","dependencies":[{"issue_id":"claude-status-um2","depends_on_id":"claude-status-ehp","type":"blocks","created_at":"2026-01-03T21:19:34.959754+01:00","created_by":"kostya"},{"issue_id":"claude-status-um2","depends_on_id":"claude-status-au0","type":"blocks","created_at":"2026-01-03T21:19:35.034029+01:00","created_by":"kostya"},{"issue_id":"claude-status-um2","depends_on_id":"claude-status-ajh","type":"blocks","created_at":"2026-01-03T21:19:35.104349+01:00","created_by":"kostya"},{"issue_id":"claude-status-um2","depends_on_id":"claude-status-32w","type":"blocks","created_at":"2026-01-03T21:19:35.175452+01:00","created_by":"kostya"}]}
{"id":"claude-status-yx0","title":"Add beads fields to template.StatusData","description":"Add 6 new fields to StatusData struct:\n- BeadsEnabled bool - true if .beads/ directory exists\n- BeadsOpen int - count of open issues\n- BeadsInProgress int - count of in_progress issues\n- BeadsBlocked int - count of blocked issues\n- BeadsNextTask string - title of next ready task\n- BeadsNextTaskID string - ID of next ready task","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-03T21:02:42.044768+01:00","created_by":"kostya","updated_at":"2026-01-03T21:11:43.251499+01:00","closed_at":"2026-01-03T21:11:43.251499+01:00","close_reason":"Implemented beads widget feature","dependencies":[{"issue_id":"claude-status-yx0","depends_on_id":"claude-status-sei","type":"parent-child","created_at":"2026-01-03T21:03:38.513164+01:00","created_by":"kostya"}]}
